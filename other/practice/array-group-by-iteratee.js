/**
 * Groups the elements of an array into an object where the keys are
 * generated by the `iteratee` function and the values are arrays of
 * elements that resolve to the same key.
 *
 * @param {Array<any>} arr The array to group.
 * @param {Function} iteratee The function invoked per iteration to generate the grouping key.
 *                            It receives the element, its index, and the original array.
 * @returns {Object<string, Array<any>>} An object with keys as grouping criteria and values as arrays of grouped elements.
 */
function arrayGroupByIteratee(arr, iteratee) {
  if (!Array.isArray(arr)) {
    throw new TypeError('Expected an array for the first argument.');
  }
  if (typeof iteratee !== 'function') {
    throw new TypeError('Expected a function for the second argument (iteratee).');
  }

  const result = {};

  for (let i = 0; i < arr.length; i++) {
    const element = arr[i];
    const key = iteratee(element, i, arr); // Can be any type, but will be coerced to string for object keys.

    if (!result[key]) {
      result[key] = [];
    }
    result[key].push(element);
  }

  return result;
}

module.exports = arrayGroupByIteratee;
